- id: patio_lights_on_at_night
  alias: 'Patio Lights On At Night'
  initial_state: 'on'
  trigger:
    - platform: sun
      event: sunset
    - platform: state
      entity_id: binary_sensor.presence_all
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: binary_sensor.presence_all
        state: 'on'
      - condition: state
        entity_id: sun.sun
        state: 'below_horizon'
  action:  
    - service: homeassistant.turn_on
      entity_id:
        - switch.patio_lights
    - service: light.turn_on
      data:
        entity_id: light.pool_lights
        effect: Blue


- id: pool_lights_double_tap_up
  alias: "Pool Lights Double Tap Up"
  initial_state: 'on'
  trigger:
    - platform: state
      entity_id: binary_sensor.pool_lights_double_tap_up
      to: 'on'
  action:
    - service: switch.turn_on
      entity_id: switch.patio_lights


- id: pool_lights_double_tap_down
  alias: "Pool Lights Double Tap Down"
  initial_state: 'on'
  trigger:
    - platform: state
      entity_id: binary_sensor.pool_lights_double_tap_down
      to: 'on'
  action:
    - service: switch.turn_off
      entity_id: switch.patio_lights
      

- id: fountain_bird_bath_for_pool_party
  alias: 'Fountain and Bird Bath for Pool Party'
  initial_state: 'on'
  trigger:
    - platform: state
      entity_id: input_boolean.pool_party_mode
  action:  
    - service_template: >
        homeassistant.{% if trigger.to_state.state == 'on' %}turn_on{% else %}turn_off{% endif %}
      entity_id:
        - switch.fountain
        - switch.bird_bath


- id: lights_for_pool_party
  alias: 'Lights for Pool Party'
  initial_state: 'on'
  trigger:
    - platform: sun
      event: sunset
    - platform: state
      entity_id: input_boolean.pool_party_mode
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.pool_party_mode
        state: 'on'
      - condition: state
        entity_id: sun.sun
        state: 'below_horizon'
  action:  
    - service: light.turn_on
      data:
        brightness_pct: 50
      entity_id:
        - light.back
        - light.deck
        - light.gazebo
    - service: light.turn_on
      entity_id:
        - light.pool_lights

